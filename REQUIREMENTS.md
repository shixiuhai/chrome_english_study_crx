# 英语学习助手插件需求文档

## 功能概述
实现Chrome插件在WhatsApp Web页面中标记并学习英语单词/词组的功能

## 核心功能
1. **单词标记**
   - 鼠标选中文本自动识别单词/词组
   - 自动添加蓝色下划线标记
   - 悬停显示翻译提示框
   - 新增支持音标显示(英式/美式发音)

2. **自动标记**
   - 页面加载时自动标记已保存的所有单词/词组
   - 支持动态加载内容的自动标记

3. **词组支持** 
   - 支持多单词词组的标记（如"thank you"）
   - 智能识别词组边界
   - 新增词组音标支持

4. **URL排除**
   - 新增自动识别并排除URL文本的标记

5. **数据存储**
   - 本地存储所有标记记录
   - 按单词/词组分类存储
   - 新增音标数据存储

## 技术实现

### content.js 主要功能
- 实现WordMarker类负责内容标记
- 包含以下核心方法：
  - `initPageMarks()`: 初始化页面标记
  - `setupMutationObserver()`: 监听动态内容
  - `processTextNode()`: 处理文本节点
  - `markExistingWord()`: 标记现有单词
  - `getMarks()`: 获取存储的标记
  - 新增`isUrl()`: 检测URL文本

### background.js 主要功能
- 数据存储管理(Chrome storage API)
- 消息通信处理
- 单词翻译功能
- 新增音标获取功能(batchGetPhonetics)
- 新增音标批量更新功能(batchUpdatePhonetics)

## API需求
1. 翻译API: /chrome/crx/translate?word=xxx (返回: { "text": "翻译结果" })
2. 音标API: /chrome/crx/phonetics?word=xxx (返回: { "phoneticText": "/音标/", "audioUrl": "音频地址" })

## 测试用例
1. 基础测试
   - 单个单词标记与自动加载
   - 词组标记与自动加载
   - 特殊符号处理（如can't）
   - URL文本识别排除

2. 高级测试
   - 页面刷新后标记保持
   - 滚动加载新内容自动标记
   - 大批量单词标记性能
   - 音标获取与显示功能

## 已知限制
1. 无法标记图片中的文字
2. 复合嵌套结构的文本可能识别不全
3. 极端情况下可能影响页面性能
4. 某些稀有词组的音标可能获取失败

## 版权信息
© 2026 英语学习插件开发团队
